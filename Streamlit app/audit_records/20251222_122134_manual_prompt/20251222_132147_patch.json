{
  "timestamp": "2025-12-22T13:23:04.314453",
  "original_code": "import xml.etree.ElementTree as ET\n\ndef parse_xml_string(xml_string):\n    return ET.fromstring(xml_string)",
  "patched_code": "import xml.etree.ElementTree as ET\n\ndef validate_input(user_input, input_type='string', max_length=None, allowed_chars=None):\n    \"\"\"Validate user input with type checking and sanitization.\"\"\"\n    if user_input is None:\n        raise ValueError(\"Input cannot be None\")\n    \n    if input_type == 'string':\n        if not isinstance(user_input, str):\n            raise TypeError(\"Expected string input\")\n        if max_length and len(user_input) > max_length:\n            raise ValueError(f\"Input exceeds maximum length of {max_length}\")\n        if allowed_chars and not all(c in allowed_chars for c in user_input):\n            raise ValueError(\"Input contains invalid characters\")\n    elif input_type == 'int':\n        try:\n            return int(user_input)\n        except ValueError:\n            raise ValueError(\"Input must be an integer\")\n    \n    return user_input\n\n\n\ndef parse_xml_string(xml_string):\n    return ET.fromstring(xml_string)",
  "changes_applied": [
    {
      "cwe_id": "020",
      "cwe_name": "Improper Input Validation",
      "line_number": null,
      "change_description": "Added input validation checks (review and apply validate_input() where needed)",
      "detection_method": "bandit",
      "patch_method": "rule-based"
    },
    {
      "cwe_id": "020",
      "cwe_name": "Improper Input Validation",
      "line_number": null,
      "change_description": "Added input validation checks (review and apply validate_input() where needed)",
      "detection_method": "bandit",
      "patch_method": "rule-based"
    }
  ],
  "unpatched_vulnerabilities": [],
  "patch_success_rate": 1.0
}