{
  "timestamp": "2025-12-19T16:45:45.189246",
  "original_code": "@app.route(\"/renderHtml\")\ndef renderHTML():\n    name = request.args.get(\"name\", \"World\")\n    html_content = f\"<html><body><h1>Hello {name}</h1></body></html>\"\n    response = make_response(html_content)\n    response.headers[\"Content-Type\"] = \"text/html\"\n    return response",
  "patched_code": "from flask import render_template, request, escape\n\n@app.route(\"/renderHtml\")\ndef renderHTML():\n    name = request.args.get(\"name\", \"World\")\n    safe_name = escape(name)\n    return render_template(\"greeting.html\", name=safe_name)\n```\n\n```html\n<html><body><h1>Hello {{ name|safe }}</h1></body></html>",
  "changes_applied": [
    {
      "cwe_id": "079",
      "cwe_name": "Cross-Site Scripting (XSS)",
      "line_number": null,
      "change_description": "LLM-generated patch for CWE-079",
      "detection_method": "semgrep",
      "patch_method": "llm-based"
    },
    {
      "cwe_id": "096",
      "cwe_name": "Unknown Vulnerability",
      "line_number": null,
      "change_description": "LLM-generated patch for CWE-096",
      "detection_method": "semgrep",
      "patch_method": "llm-based"
    }
  ],
  "unpatched_vulnerabilities": [],
  "patch_success_rate": 1.0
}